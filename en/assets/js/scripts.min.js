const header=document.querySelector('.js-header');const stickyClass='sticky';let lastScrollTop=0;let isWaiting=false;window.addEventListener('scroll',()=>{if(!isWaiting){window.requestAnimationFrame(()=>{let currentScroll=window.scrollY||window.pageYOffset||document.documentElement.scrollTop;if(currentScroll>lastScrollTop){header.classList.remove(stickyClass);}else if(currentScroll<lastScrollTop&&currentScroll>0){header.classList.add(stickyClass);}else if(currentScroll<=0){header.classList.remove(stickyClass);}
lastScrollTop=currentScroll;isWaiting=false;});isWaiting=true;}},false);(function(menuConfig){var defaultConfig={mobileMenuMode:'overlay',animationSpeed:300,submenuWidth:300,doubleClickTime:500,mobileMenuExpandableSubmenus:false,isHoverMenu:true,wrapperSelector:'.navbar',buttonSelector:'.navbar__toggle',menuSelector:'.navbar__menu',submenuSelector:'.navbar__submenu',mobileMenuSidebarLogoSelector:null,mobileMenuSidebarLogoUrl:null,relatedContainerForOverlayMenuSelector:null,ariaButtonAttribute:'aria-haspopup',separatorItemClass:'is-separator',parentItemClass:'has-submenu',submenuLeftPositionClass:'is-left-submenu',submenuRightPositionClass:'is-right-submenu',mobileMenuOverlayClass:'navbar_mobile_overlay',mobileMenuSubmenuWrapperClass:'navbar__submenu_wrapper',mobileMenuSidebarClass:'navbar_mobile_sidebar',mobileMenuSidebarOverlayClass:'navbar_mobile_sidebar__overlay',hiddenElementClass:'is-hidden',openedMenuClass:'is-active',noScrollClass:'no-scroll',relatedContainerForOverlayMenuClass:'is-visible'};var config={};Object.keys(defaultConfig).forEach(function(key){config[key]=defaultConfig[key];});if(typeof menuConfig==='object'){Object.keys(menuConfig).forEach(function(key){config[key]=menuConfig[key];});}
function init(){if(!document.querySelectorAll(config.wrapperSelector).length){return;}
initSubmenuPositions();if(config.mobileMenuMode==='overlay'){initMobileMenuOverlay();}else if(config.mobileMenuMode==='sidebar'){initMobileMenuSidebar();}
initClosingMenuOnClickLink();if(!config.isHoverMenu){initAriaAttributes();}};function initSubmenuPositions(){var submenuParents=document.querySelectorAll(config.wrapperSelector+' .'+config.parentItemClass);for(var i=0;i<submenuParents.length;i++){var eventTrigger=config.isHoverMenu?'mouseenter':'click';submenuParents[i].addEventListener(eventTrigger,function(){var submenu=this.querySelector(config.submenuSelector);var itemPosition=this.getBoundingClientRect().left;var widthMultiplier=2;if(this.parentNode===document.querySelector(config.menuSelector)){widthMultiplier=1;}
if(config.submenuWidth!=='auto'){var submenuPotentialPosition=itemPosition+(config.submenuWidth*widthMultiplier);if(window.innerWidth<submenuPotentialPosition){submenu.classList.remove(config.submenuLeftPositionClass);submenu.classList.add(config.submenuRightPositionClass);}else{submenu.classList.remove(config.submenuRightPositionClass);submenu.classList.add(config.submenuLeftPositionClass);}}else{var submenuPotentialPosition=0;var submenuPosition=0;if(widthMultiplier===1){submenuPotentialPosition=itemPosition+submenu.clientWidth;}else{submenuPotentialPosition=itemPosition+this.clientWidth+submenu.clientWidth;}
if(window.innerWidth<submenuPotentialPosition){submenu.classList.remove(config.submenuLeftPositionClass);submenu.classList.add(config.submenuRightPositionClass);submenuPosition=-1*submenu.clientWidth;submenu.removeAttribute('style');if(widthMultiplier===1){submenuPosition=0;submenu.style.right=submenuPosition+'px';}else{submenu.style.right=this.clientWidth+'px';}}else{submenu.classList.remove(config.submenuRightPositionClass);submenu.classList.add(config.submenuLeftPositionClass);submenuPosition=this.clientWidth;if(widthMultiplier===1){submenuPosition=0;}
submenu.removeAttribute('style');submenu.style.left=submenuPosition+'px';}}
submenu.setAttribute('aria-hidden',false);});if(config.isHoverMenu){submenuParents[i].addEventListener('mouseleave',function(){var submenu=this.querySelector(config.submenuSelector);submenu.removeAttribute('style');submenu.setAttribute('aria-hidden',true);});}}}
function initMobileMenuOverlay(){var menuWrapper=document.createElement('div');menuWrapper.classList.add(config.mobileMenuOverlayClass);menuWrapper.classList.add(config.hiddenElementClass);var menuContentHTML=document.querySelector(config.menuSelector).outerHTML;menuWrapper.innerHTML=menuContentHTML;document.body.appendChild(menuWrapper);if(config.mobileMenuExpandableSubmenus){wrapSubmenusIntoContainer(menuWrapper);initToggleSubmenu(menuWrapper);}else{setAriaForSubmenus(menuWrapper);}
var button=document.querySelector(config.buttonSelector);button.addEventListener('click',function(){var relatedContainer=document.querySelector(config.relatedContainerForOverlayMenuSelector);menuWrapper.classList.toggle(config.hiddenElementClass);button.classList.toggle(config.openedMenuClass);button.setAttribute(config.ariaButtonAttribute,button.classList.contains(config.openedMenuClass));if(button.classList.contains(config.openedMenuClass)){document.documentElement.classList.add(config.noScrollClass);if(relatedContainer){relatedContainer.classList.add(config.relatedContainerForOverlayMenuClass);}}else{document.documentElement.classList.remove(config.noScrollClass);if(relatedContainer){relatedContainer.classList.remove(config.relatedContainerForOverlayMenuClass);}}});}
function initMobileMenuSidebar(){var menuWrapper=document.createElement('div');menuWrapper.classList.add(config.mobileMenuSidebarClass);menuWrapper.classList.add(config.hiddenElementClass);var menuContentHTML='';if(config.mobileMenuSidebarLogoSelector!==null){menuContentHTML=document.querySelector(config.mobileMenuSidebarLogoSelector).outerHTML;}else if(config.mobileMenuSidebarLogoUrl!==null){menuContentHTML='<img src="'+config.mobileMenuSidebarLogoUrl+'" alt="" />';}
menuContentHTML+=document.querySelector(config.menuSelector).outerHTML;menuWrapper.innerHTML=menuContentHTML;var menuOverlay=document.createElement('div');menuOverlay.classList.add(config.mobileMenuSidebarOverlayClass);menuOverlay.classList.add(config.hiddenElementClass);document.body.appendChild(menuOverlay);document.body.appendChild(menuWrapper);if(config.mobileMenuExpandableSubmenus){wrapSubmenusIntoContainer(menuWrapper);initToggleSubmenu(menuWrapper);}else{setAriaForSubmenus(menuWrapper);}
menuWrapper.addEventListener('click',function(e){e.stopPropagation();});menuOverlay.addEventListener('click',function(){menuWrapper.classList.add(config.hiddenElementClass);menuOverlay.classList.add(config.hiddenElementClass);button.classList.remove(config.openedMenuClass);button.setAttribute(config.ariaButtonAttribute,false);document.documentElement.classList.remove(config.noScrollClass);});var button=document.querySelector(config.buttonSelector);button.addEventListener('click',function(){menuWrapper.classList.toggle(config.hiddenElementClass);menuOverlay.classList.toggle(config.hiddenElementClass);button.classList.toggle(config.openedMenuClass);button.setAttribute(config.ariaButtonAttribute,button.classList.contains(config.openedMenuClass));document.documentElement.classList.toggle(config.noScrollClass);});}
function setAriaForSubmenus(menuWrapper){var submenus=menuWrapper.querySelectorAll(config.submenuSelector);for(var i=0;i<submenus.length;i++){submenus[i].setAttribute('aria-hidden',false);}}
function wrapSubmenusIntoContainer(menuWrapper){var submenus=menuWrapper.querySelectorAll(config.submenuSelector);for(var i=0;i<submenus.length;i++){var submenuWrapper=document.createElement('div');submenuWrapper.classList.add(config.mobileMenuSubmenuWrapperClass);submenus[i].parentNode.insertBefore(submenuWrapper,submenus[i]);submenuWrapper.appendChild(submenus[i]);}}
function initToggleSubmenu(menuWrapper){var parents=menuWrapper.querySelectorAll('.'+config.parentItemClass);for(var i=0;i<parents.length;i++){parents[i].addEventListener('click',function(e){e.stopPropagation();var submenu=this.querySelector('.'+config.mobileMenuSubmenuWrapperClass);var content=submenu.firstElementChild;if(submenu.classList.contains(config.openedMenuClass)){var height=content.clientHeight;submenu.style.height=height+'px';setTimeout(function(){submenu.style.height='0px';},0);setTimeout(function(){submenu.removeAttribute('style');submenu.classList.remove(config.openedMenuClass);},config.animationSpeed);content.setAttribute('aria-hidden',true);content.parentNode.firstElementChild.setAttribute('aria-expanded',false);}else{var height=content.clientHeight;submenu.classList.add(config.openedMenuClass);submenu.style.height='0px';setTimeout(function(){submenu.style.height=height+'px';},0);setTimeout(function(){submenu.removeAttribute('style');},config.animationSpeed);content.setAttribute('aria-hidden',false);content.parentNode.firstElementChild.setAttribute('aria-expanded',true);}});var childNodes=parents[i].children;for(var j=0;j<childNodes.length;j++){if(childNodes[j].tagName==='A'){childNodes[j].addEventListener('click',function(e){var lastClick=parseInt(this.getAttribute('data-last-click'),10);var currentTime=+new Date();if(isNaN(lastClick)){e.preventDefault();this.setAttribute('data-last-click',currentTime);}else if(lastClick+config.doubleClickTime<=currentTime){e.preventDefault();this.setAttribute('data-last-click',currentTime);}else if(lastClick+config.doubleClickTime>currentTime){e.stopPropagation();closeMenu(this,true);}});}}}}
function initAriaAttributes(){var allAriaElements=document.querySelectorAll(config.wrapperSelector+' '+'*[aria-hidden]');for(var i=0;i<allAriaElements.length;i++){var ariaElement=allAriaElements[i];if(ariaElement.parentNode.classList.contains('active')||ariaElement.parentNode.classList.contains('active-parent')){ariaElement.setAttribute('aria-hidden','false');ariaElement.parentNode.firstElementChild.setAttribute('aria-expanded',true);}else{ariaElement.setAttribute('aria-hidden','true');ariaElement.parentNode.firstElementChild.setAttribute('aria-expanded',false);}}}
function initClosingMenuOnClickLink(){var links=document.querySelectorAll(config.menuSelector+' a');for(var i=0;i<links.length;i++){if(links[i].parentNode.classList.contains(config.parentItemClass)){continue;}
links[i].addEventListener('click',function(e){closeMenu(this,false);});}}
function closeMenu(clickedLink,forceClose){if(forceClose===false){if(clickedLink.parentNode.classList.contains(config.parentItemClass)){return;}}
var relatedContainer=document.querySelector(config.relatedContainerForOverlayMenuSelector);var button=document.querySelector(config.buttonSelector);var menuWrapper=document.querySelector('.'+config.mobileMenuOverlayClass);if(!menuWrapper){menuWrapper=document.querySelector('.'+config.mobileMenuSidebarClass);}
menuWrapper.classList.add(config.hiddenElementClass);button.classList.remove(config.openedMenuClass);button.setAttribute(config.ariaButtonAttribute,false);document.documentElement.classList.remove(config.noScrollClass);if(relatedContainer){relatedContainer.classList.remove(config.relatedContainerForOverlayMenuClass);}
var menuOverlay=document.querySelector('.'+config.mobileMenuSidebarOverlayClass);if(menuOverlay){menuOverlay.classList.add(config.hiddenElementClass);}}
init();})(window.publiiThemeMenuConfig);const searchButton=document.querySelector('.js-search-btn');const searchOverlay=document.querySelector('.js-search-overlay');const searchInput=document.querySelector('input[type="search"]');if(searchButton&&searchOverlay&&searchInput){searchButton.addEventListener('click',(event)=>{event.stopPropagation();searchOverlay.classList.toggle('expanded');if(searchOverlay.classList.contains('expanded')){setTimeout(()=>{searchInput.focus();},60);}});searchOverlay.addEventListener('click',(event)=>{event.stopPropagation();});document.body.addEventListener('click',()=>{searchOverlay.classList.remove('expanded');});}
(function(){const shareButton=document.querySelector('.js-content__share-button');const sharePopup=document.querySelector('.js-content__share-popup');if(shareButton&&sharePopup){sharePopup.addEventListener('click',function(e){e.stopPropagation();});shareButton.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();sharePopup.classList.toggle('is-visible');});document.body.addEventListener('click',function(){sharePopup.classList.remove('is-visible');});}
const Config={Link:".js-share",Width:500,Height:500};const shareLinks=document.querySelectorAll(Config.Link);shareLinks.forEach(link=>{link.addEventListener('click',PopupHandler);});function PopupHandler(e){e.preventDefault();const target=e.target.closest(Config.Link);if(!target)return;if(sharePopup){sharePopup.classList.remove('is-visible');}
const px=Math.floor((window.innerWidth-Config.Width)/2);const py=Math.floor((window.innerHeight-Config.Height)/2);const linkHref=target.href;const popup=window.open(linkHref,"social",`width=${Config.Width},height=${Config.Height},left=${px},top=${py},location=0,menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1`);if(popup){popup.focus();}}})();document.addEventListener('DOMContentLoaded',()=>{const backToTopButton=document.getElementById('backToTop');if(backToTopButton){const backToTopScrollFunction=()=>{if(document.body.scrollTop>400||document.documentElement.scrollTop>400){backToTopButton.classList.add('is-visible');}else{backToTopButton.classList.remove('is-visible');}};const backToTopFunction=()=>{window.scrollTo({top:0,behavior:'smooth'});};window.addEventListener('scroll',backToTopScrollFunction);backToTopButton.addEventListener('click',backToTopFunction);}});(function(){let wrappers=document.querySelectorAll('.post__video, .post__iframe');for(let i=0;i<wrappers.length;i++){let embed=wrappers[i].querySelector('iframe, embed, video, object');if(!embed){continue;}
if(embed.getAttribute('data-responsive')==='false'){continue;}
let w=embed.getAttribute('width');let h=embed.getAttribute('height');let ratio=false;if(!w||!h){continue;}
if(w.indexOf('%')>-1&&h.indexOf('%')>-1){w=parseFloat(w.replace('%',''));h=parseFloat(h.replace('%',''));ratio=h/w;}else if(w.indexOf('%')===-1&&h.indexOf('%')===-1){w=parseInt(w,10);h=parseInt(h,10);ratio=h/w;}
if(ratio!==false){let ratioValue=(ratio*100)+'%';wrappers[i].setAttribute('style','--embed-aspect-ratio:'+ratioValue);}}})();
document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".intro-loader"),t=document.querySelector(".intro-logo"),a=window.location.pathname,l=a.endsWith("/")||a.endsWith("/index.html");e&&t&&l?(document.body.classList.replace("loading-page-template","page-template"),setTimeout(()=>{t.style.transition="all 0.6s ease",t.style.transform="translateY(-50px)",t.style.opacity="0",setTimeout(()=>{e.style.transition="opacity 0.5s ease",e.style.opacity="0",setTimeout(()=>{e.style.display="none"},500)},600)},1e3)):e&&(e&&e.remove(),setTimeout(()=>{document.body.classList.replace("loading-page-template","page-template")},1))});
const CONTACT_API_URL="https://mailapi.isymap.com/";let isSubmitting=!1;async function handleFormSubmit(e){if(e.preventDefault(),isSubmitting)return void console.log("Soumission déjà en cours...");const t=e.target,s=t.querySelector(".contact-from-envoyer"),o=s.textContent,n=await grecaptcha.execute("6Lek4CAsAAAAAMJmjs-21-JBevAZTk21Jy35f5aP",{action:"contact"}),r={name:t.nom.value.trim(),email:t.email.value.trim(),subject:"Contact depuis le site ISYmap",message:constructMessage(t),recaptcha_token:n};if(validateForm(r)){isSubmitting=!0,s.disabled=!0,s.textContent="Envoi en cours...",s.classList.add("loading");try{const e=await fetch(`${CONTACT_API_URL}contact`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=await e.json();e.ok?(showSuccessMessage(),t.reset()):(400===e.status?showErrorMessage("Votre message n'a pas pu être envoyé. Veuillez vérifier le contenu et réessayer."):422===e.status?showErrorMessage("Certains champs ne sont pas correctement remplis. Veuillez vérifier vos informations."):showErrorMessage("Une erreur est survenue lors de l'envoi. Veuillez réessayer plus tard."),console.error("Erreur API:",s))}catch(e){console.error("Erreur lors de l'envoi:",e),showErrorMessage("Impossible de contacter le serveur. Veuillez vérifier votre connexion internet et réessayer.")}finally{isSubmitting=!1,s.disabled=!1,s.textContent=o,s.classList.remove("loading")}}}function constructMessage(e){const t=e.nom.value.trim(),s=e.prenom.value.trim(),o=e.societe.value.trim();let n="";return(t||s)&&(n+=`Nom complet: ${t}${s?" "+s:""}\n`),o&&(n+=`Société: ${o}\n`),n+="\n--- Message ---\n\n",n+=e.message.value.trim(),n}function validateForm(e){return!e.name||e.name.length<2?(showErrorMessage("Le nom doit contenir au moins 2 caractères."),!1):e.email&&isValidEmail(e.email)?!(!e.message||e.message.length<10)||(showErrorMessage("Le message doit contenir au moins 10 caractères."),!1):(showErrorMessage("Veuillez entrer une adresse email valide."),!1)}function isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function showSuccessMessage(){const e=document.getElementById("contact-form"),t=e.closest(".contact-form-container"),s=document.createElement("div");s.className="contact-success-message",s.innerHTML='\n        <div class="alert alert-success" role="alert">\n            <h4>✅ Message envoyé avec succès !</h4>\n            <p>Merci de nous avoir contactés. Nous vous répondrons dans les plus brefs délais.</p>\n        </div>\n    ',t.insertBefore(s,e),s.scrollIntoView({behavior:"smooth",block:"center"}),e.style.opacity="0.5",setTimeout((()=>{s.remove(),e.style.opacity="1"}),1e4)}function showErrorMessage(e){const t=document.getElementById("contact-form"),s=t.closest(".contact-form-container");s.querySelectorAll(".contact-error-message").forEach((e=>e.remove()));const o=document.createElement("div");o.className="contact-error-message",o.innerHTML=`\n        <div class="alert alert-danger" role="alert">\n            <h4>❌ Erreur</h4>\n            <p>${e}</p>\n        </div>\n    `,s.insertBefore(o,t),o.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout((()=>{o.remove()}),8e3)}async function checkAPIHealth(){try{return(await fetch(`${CONTACT_API_URL}/health`,{method:"GET",headers:{"Content-Type":"application/json"}})).ok?(console.log("✅ API de contact disponible"),!0):(console.warn("⚠️ API de contact ne répond pas correctement"),!1)}catch(e){return console.error("❌ API de contact inaccessible:",e),!1}}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("contact-form");e&&(console.log("Formulaire de contact détecté - Initialisation..."),e.addEventListener("submit",handleFormSubmit))}));
document.addEventListener("DOMContentLoaded",(function(){var e=document.createElement("div");e.className="reading-progress fixed";var t=document.createElement("div");t.className="reading-progress__bar",e.appendChild(t),document.body.appendChild(e);var n=!1;function d(){var d=document.documentElement,i=(window.pageYOffset||d.scrollTop)-(d.clientTop||0),o=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-window.innerHeight;if(o<50)return e.classList.add("hidden"),void(t.style.width="0%");e.classList.remove("hidden");var a=Math.min(100,i/o*100);t.style.width=a+"%",n=!1}window.addEventListener("scroll",(function(){n||(window.requestAnimationFrame(d),n=!0)}),{passive:!0}),window.addEventListener("resize",d),window.addEventListener("load",(function(){setTimeout(d,50)})),d()}));
$("#exampleModal").on("hide.bs.modal",(function(){$("#youtubeVideo").attr("src","")})),$("#exampleModal").on("show.bs.modal",(function(){const o=$("#youtubeVideo");o.attr("src",o.data("src"))}));